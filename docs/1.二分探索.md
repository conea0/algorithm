# はじめに

今回は二分探索について解説します。
二分探索を使った答えを探索するタイプの問題についても解説します。

サンプルコードは Python と Rust で書かれています。

## 二分探索とは

覚えてますか？？
ソートしていなければならない。
ソートするのには O(n log n) かかるので、全探索の方が早い場合もある。

## 二分探索の実装

リストに対して与えられた数字が存在するか二分探索で探してください。存在する場合はそのインデックスを、存在しない場合は-1 を出力してください。

```python
l = list(map(int, input().split()))
search = int(input())
```

### 例

- 入力 1

```
31
```

- 出力 1
  配列のインデックスは 0 から始まることに注意してください。

```
30
```

- 入力 2

```
100
```

- 出力 2

```
-1
```

### 解答例

<details>
<summary>Python</summary>

```python
l = list(map(int, input().split()))
search = int(input())

left = 0
right = len(l)

while right - left > 1:
	mid = (left + right) // 2
	if l[mid] >= search:
		right = mid
	else:
		left = mid

print(right if l[right] == search else -1)

```

</details>

<details>
<summary>Rust</summary>

```rust
use proconio::input;

fn main() {
    input! {
        n: usize,
        l: [usize; n],
        s: usize
    }

    let mut left = 0usize;
    let mut right = l.len();
    let mut mid;

    while right - left > 1 {
        mid = (right + left) / 2;
        if l[mid] >= s {
            right = mid;
        } else {
            left = mid;
        }
    }

    println!("{}", if l[right] == s { right as isize } else { -1 })
}
```

</details>

### 練習問題

- 解答例を見ずに、自分で書いてみてください。[binary search1](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_k)
- [Atcoder 典型アルゴリズム問題集 A - 二分探索の練習問題](https://atcoder.jp/contests/typical-algorithm/tasks/typical_algorithm_a) を解いてみてください。

## 二分探索の典型問題(答えを二分探索)

単調増加関数または単調減少関数によって結果が返ってくるなら、答えを二分探索で探すことができます。
例えば、f(x)が単調増加関数なら、f(x) = y となる x を二分探索で探すことができます。

### 例題 1

$N$台のプリンターがあり、$1$から$N$までの番号が付けられています。プリンター$i$は$A_i$秒ごとにチラシを$1$枚印刷します。すなわち、スイッチを入れてから$A_i$秒後、$2A_i$秒後、$3A_i$秒後･･･に印刷します。すべてのプリンターのスイッチを同時に入れたとき、$K$枚目のチラシが印刷されるのは何秒後でしょうか。

#### io sample

入力は以下の形式で与えられます

```
N K
A_1 A_2 ... A_N
```

何秒後に$K$枚目のチラシが印刷されるかを出力してください。

- 入力 1

```
4 10
1 2 3 4
```

- 出力 1

```
6
```

表にすると、

| 秒数         | 1   | 2   | 3   | 4   | 5   | 6   | 7   |
| ------------ | --- | --- | --- | --- | --- | --- | --- |
| プリンター 1 | ○   | ○   | ○   | ○   | ○   | ○   | ○   |
| プリンター 2 |     | ○   |     | ○   |     | ○   |     |
| プリンター 3 |     |     | ○   |     |     | ○   |     |
| プリンター 4 |     |     |     | ○   |     |     | ○   |

となり、6秒後に10枚目のチラシが印刷されます。

### 解法

x秒後に何枚印刷されているか？を返す関数を作り、xに対して二分探索を行います。

x秒後に何枚印刷されているか？を調べるには、x秒を各プリンターの印刷間隔で割った商の合計を求めれば良いです。

例えば上の例でx=3の場合、

- プリンター1は 3 // 1 = 3 枚印刷
- プリンター2は 3 // 2 = 1 枚印刷
- プリンター3は 3 // 3 = 1 枚印刷

となります(完了した枚数を知りたいので小数点は切り捨てています。)

これは計算量が$O(N)$となります。

二分探索で十分に大きなright(制約を見ると答えは$10^9$を超えないと書いてあるのでこれを使います)を用意し、x秒後に印刷されている枚数がK枚以上かどうかを調べます。

### 解答例

<details>
<summary>Python</summary>

```python
